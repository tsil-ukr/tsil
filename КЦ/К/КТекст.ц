взяти визначення К;
взяти визначення КД;

зовнішня дія tsil_replace_backslashes(значення: памʼять<п8>): памʼять<п8>;
зовнішня дія strlen(значення: памʼять<п8>): size_t;

секція ц {
  місцева дія скомпілювати_текст(К: адреса<Компілятор>, інформація_середовища: ІнформаціяСередовища, місцезнаходження: адреса<Місцезнаходження>, дані: адреса<АСДДаніЗначенняТекст>, очікуваний_тип: адреса<ОбʼєктТипу>): Результат {
    якщо дані.ідентифікатор == пусто {
      змінна ціль значення = виділити<п8>(strlen(дані.значення) + 1);
      якщо strlen(дані.значення) == 0 {
      } інакше {
        змінна ціль розмір_значення = КД::перекодувати_з_Ю8(дані.значення, strlen(дані.значення), значення);
        якщо розмір_значення == 0 {
          ціль помилка_компіляції = виділити_помилку_компіляції(місцезнаходження, ю8"Невідомий символ КД");
          вернути результат_помилка(помилка_компіляції);
        }
      }
      значення[strlen(дані.значення)] = 0;
      ціль llvm_value = LLVM::const_string(К.L, значення);
      якщо llvm_value == пусто {
        ціль помилка_компіляції = виділити_помилку_компіляції(місцезнаходження, ю8"Помилка LLVM створення тексту");
        вернути результат_помилка(помилка_компіляції);
      }
      ціль обʼєкт_типу_комірки = виділити_обʼєкт_типу(ВидТипуПамʼять);
      обʼєкт_типу_комірки.тип_памʼяті = К.тип_п8;
      обʼєкт_типу_комірки.llvm_type = LLVM::pointer(К.L);
      ціль обʼєкт_значення: ОбʼєктЗначення;
      обʼєкт_значення.тип = обʼєкт_типу_комірки;
      обʼєкт_значення.llvm_value = llvm_value;
      вернути Результат { Обʼєкт { ВидОбʼєктаЗначення, дані = обʼєкт_значення }, помилка = пусто };
    }
    якщо strcmp(дані.ідентифікатор.значення, ю8"ю8") != 0 {
      ціль помилка_компіляції = виділити_помилку_компіляції(місцезнаходження, ю8"Таке кодування наразі не підтримується, використовуйте ю8 (наприклад ю8\"Вперед до Цілі!\")");
      вернути результат_помилка(помилка_компіляції);
    }
    ціль llvm_value = LLVM::const_string(К.L, tsil_replace_backslashes(дані.значення));
    якщо llvm_value == пусто {
      ціль помилка_компіляції = виділити_помилку_компіляції(місцезнаходження, ю8"Помилка LLVM створення юнікоду");
      вернути результат_помилка(помилка_компіляції);
    }
    ціль обʼєкт_типу_комірки = виділити_обʼєкт_типу(ВидТипуПамʼять);
    обʼєкт_типу_комірки.тип_памʼяті = К.тип_п8;
    обʼєкт_типу_комірки.llvm_type = LLVM::pointer(К.L);
    ціль обʼєкт_значення: ОбʼєктЗначення;
    обʼєкт_значення.тип = обʼєкт_типу_комірки;
    обʼєкт_значення.llvm_value = llvm_value;
    вернути Результат { Обʼєкт { ВидОбʼєктаЗначення, дані = обʼєкт_значення }, помилка = пусто };
  }
}