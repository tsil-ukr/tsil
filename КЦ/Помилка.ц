взяти визначення Ц;

зовнішня дія позитивне_в_ю8(значення: позитивне): памʼять<п8>;

секція ц {
  дія видимість_в_ю8(видимість: позитивне): памʼять<п8> {
    якщо видимість == ВидимістьДіїЗовнішня {
      вернути ю8"зовнішня";
    } інакше якщо видимість == ВидимістьДіїМісцева {
      вернути ю8"місцева";
    } інакше {
      вернути ю8"внутрішня";
    }
  }

  дія обʼєкт_типу_як_ю8сі(обʼєкт_типу: комірка<ОбʼєктТипу>): памʼять<п8> {
    якщо обʼєкт_типу.вид == ВидТипуНативний {
      якщо обʼєкт_типу.назва == пусто {
        вернути ю8"<тип без назви>";
      }
      вернути обʼєкт_типу.назва;
    }
    якщо обʼєкт_типу.вид == ВидТипуСтруктура {
      якщо обʼєкт_типу.назва == пусто {
        вернути ю8"<структура без назви>";
      }
      вернути обʼєкт_типу.назва;
    }
    якщо обʼєкт_типу.вид == ВидТипуДія {
      вернути ю8"<дія>";
    }
    якщо обʼєкт_типу.вид == ВидТипуКомірка {
      ціль буфер_ю8 = створити_буфер_ю8();
      додати_до_буфера_ю8(буфер_ю8, ю8"комірка<");
      додати_до_буфера_ю8(буфер_ю8, обʼєкт_типу_як_ю8сі(обʼєкт_типу.тип_комірки));
      додати_до_буфера_ю8(буфер_ю8, ю8">");
      ціль результат = створити_ю8_сі_з_буфера(буфер_ю8);
      звільнити_буфер_ю8(буфер_ю8);
      вернути результат;
    }
    якщо обʼєкт_типу.вид == ВидТипуМасив {
      ціль буфер_ю8 = створити_буфер_ю8();
      додати_до_буфера_ю8(буфер_ю8, обʼєкт_типу_як_ю8сі(обʼєкт_типу.тип_масиву));
      додати_до_буфера_ю8(буфер_ю8, ю8"[");
//      додати_до_буфера_ю8(буфер_ю8, розмір);
      додати_до_буфера_ю8(буфер_ю8, ю8"]");
      ціль результат = створити_ю8_сі_з_буфера(буфер_ю8);
      звільнити_буфер_ю8(буфер_ю8);
      вернути результат;
    }
    якщо обʼєкт_типу.вид == ВидТипуПамʼять {
      ціль буфер_ю8 = створити_буфер_ю8();
      додати_до_буфера_ю8(буфер_ю8, ю8"памʼять<");
      додати_до_буфера_ю8(буфер_ю8, обʼєкт_типу_як_ю8сі(обʼєкт_типу.тип_памʼяті));
      додати_до_буфера_ю8(буфер_ю8, ю8">");
      ціль результат = створити_ю8_сі_з_буфера(буфер_ю8);
      звільнити_буфер_ю8(буфер_ю8);
      вернути результат;
    }
    вернути ю8"<тип без назви>";
  }

  місцева дія виділити_помилку_компіляції(місцезнаходження: комірка<Місцезнаходження>, повідомлення: памʼять<п8>): комірка<ПомилкаКомпіляції> {
    ціль помилка = виділити<ПомилкаКомпіляції>();
    помилка.місцезнаходження = місцезнаходження;
    помилка.повідомлення = повідомлення;
    вернути помилка;
  }

  місцева дія виділити_помилку_компіляції_субʼєкт_вже_визначено(місцезнаходження: комірка<Місцезнаходження>, назва: памʼять<п8>): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Субʼєкт \"");
    додати_до_буфера_ю8(буфер_повідомлення, назва);
    додати_до_буфера_ю8(буфер_повідомлення, ю8"\" вже визначено");
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_субʼєкт_не_визначено(місцезнаходження: комірка<Місцезнаходження>, назва: памʼять<п8>): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Субʼєкт \"");
    додати_до_буфера_ю8(буфер_повідомлення, назва);
    додати_до_буфера_ю8(буфер_повідомлення, ю8"\" не визначено");
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_неможливо_виконати(місцезнаходження: комірка<Місцезнаходження>, обʼєкт: Обʼєкт): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Неможливо виконати");
    якщо обʼєкт.вид == ВидОбʼєктаТипу {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" структуру");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаДії {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" дію");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаЗначення {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" \"");
      ціль обʼєкт_значення = обʼєкт.дані як ОбʼєктЗначення;
      додати_до_буфера_ю8(буфер_повідомлення, обʼєкт_типу_як_ю8сі(обʼєкт_значення.тип));
      додати_до_буфера_ю8(буфер_повідомлення, ю8"\"");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаСекції {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" секцію");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаНезавантаженогоЗначення {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" \"");
      ціль обʼєкт_незавантаженого_значення = обʼєкт.дані як ОбʼєктНезавантаженогоЗначення;
      додати_до_буфера_ю8(буфер_повідомлення, обʼєкт_типу_як_ю8сі(обʼєкт_незавантаженого_значення.тип));
      додати_до_буфера_ю8(буфер_повідомлення, ю8"\"");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаШаблону {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" шаблон");
    } інакше {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" невідоме значення (вітання, ви натрапили на помилку компілятора)");
    }
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_неможливо_виконати_шаблон(місцезнаходження: комірка<Місцезнаходження>, обʼєкт: Обʼєкт): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Неможливо виконати шаблон");
    якщо обʼєкт.вид == ВидОбʼєктаТипу {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" структуру");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаДії {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" дію");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаЗначення {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" \"");
      ціль обʼєкт_значення = обʼєкт.дані як ОбʼєктЗначення;
      додати_до_буфера_ю8(буфер_повідомлення, обʼєкт_типу_як_ю8сі(обʼєкт_значення.тип));
      додати_до_буфера_ю8(буфер_повідомлення, ю8"\"");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаСекції {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" секцію");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаНезавантаженогоЗначення {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" \"");
      ціль обʼєкт_незавантаженого_значення = обʼєкт.дані як ОбʼєктНезавантаженогоЗначення;
      додати_до_буфера_ю8(буфер_повідомлення, обʼєкт_типу_як_ю8сі(обʼєкт_незавантаженого_значення.тип));
      додати_до_буфера_ю8(буфер_повідомлення, ю8"\"");
    } інакше якщо обʼєкт.вид == ВидОбʼєктаШаблону {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" шаблон");
    } інакше {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" невідоме значення (вітання, ви натрапили на помилку компілятора)");
    }
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_невірна_кількість_аргументів(місцезнаходження: комірка<Місцезнаходження>, очікується: позитивне, отримано: позитивне): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Невірна кількість аргументів");
    додати_до_буфера_ю8(буфер_повідомлення, ю8": очікується ");
    додати_до_буфера_ю8(буфер_повідомлення, позитивне_в_ю8(очікується));
    додати_до_буфера_ю8(буфер_повідомлення, ю8", отримано ");
    додати_до_буфера_ю8(буфер_повідомлення, позитивне_в_ю8(отримано));
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_невірна_кількість_аргументів_шаблону(місцезнаходження: комірка<Місцезнаходження>, очікується: позитивне, отримано: позитивне): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Невірна кількість аргументів шаблону");
    додати_до_буфера_ю8(буфер_повідомлення, ю8": очікується ");
    додати_до_буфера_ю8(буфер_повідомлення, позитивне_в_ю8(очікується));
    додати_до_буфера_ю8(буфер_повідомлення, ю8", отримано ");
    додати_до_буфера_ю8(буфер_повідомлення, позитивне_в_ю8(отримано));
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_невірний_тип_аргумента(місцезнаходження: комірка<Місцезнаходження>, назва: памʼять<п8>, очікується: комірка<ОбʼєктТипу>, отримано: комірка<ОбʼєктТипу>): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Невірний тип аргумента");
    якщо назва != пусто {
      додати_до_буфера_ю8(буфер_повідомлення, ю8" \"");
      додати_до_буфера_ю8(буфер_повідомлення, назва);
      додати_до_буфера_ю8(буфер_повідомлення, ю8"\"");
    }
    додати_до_буфера_ю8(буфер_повідомлення, ю8": очікується \"");
    додати_до_буфера_ю8(буфер_повідомлення, обʼєкт_типу_як_ю8сі(очікується));
    додати_до_буфера_ю8(буфер_повідомлення, ю8"\", отримано \"");
    додати_до_буфера_ю8(буфер_повідомлення, обʼєкт_типу_як_ю8сі(отримано));
    додати_до_буфера_ю8(буфер_повідомлення, ю8"\"");
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_кількість_параметрів_дії_не_співпадає(місцезнаходження: комірка<Місцезнаходження>, очікується: позитивне, отримано: позитивне): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Кількість параметрів дії не співпадає");
    додати_до_буфера_ю8(буфер_повідомлення, ю8": очікується ");
    додати_до_буфера_ю8(буфер_повідомлення, позитивне_в_ю8(очікується));
    додати_до_буфера_ю8(буфер_повідомлення, ю8", отримано ");
    додати_до_буфера_ю8(буфер_повідомлення, позитивне_в_ю8(отримано));
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }

  місцева дія виділити_помилку_компіляції_видимість_дії_не_співпадає(місцезнаходження: комірка<Місцезнаходження>, очікується: позитивне, отримано: позитивне): комірка<ПомилкаКомпіляції> {
    ціль помилка_компіляції = виділити<ПомилкаКомпіляції>();
    помилка_компіляції.місцезнаходження = місцезнаходження;
    ціль буфер_повідомлення = створити_буфер_ю8();
    додати_до_буфера_ю8(буфер_повідомлення, ю8"Видимість дії не співпадає");
    додати_до_буфера_ю8(буфер_повідомлення, ю8": очікується ");
    додати_до_буфера_ю8(буфер_повідомлення, видимість_в_ю8(очікується));
    додати_до_буфера_ю8(буфер_повідомлення, ю8", отримано ");
    додати_до_буфера_ю8(буфер_повідомлення, видимість_в_ю8(отримано));
    помилка_компіляції.повідомлення = створити_ю8_сі_з_буфера(буфер_повідомлення);
    звільнити_буфер_ю8(буфер_повідомлення);
    вернути помилка_компіляції;
  }
}