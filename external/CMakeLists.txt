cmake_minimum_required(VERSION 3.26)
project(tsil)

set(CMAKE_CXX_STANDARD 20)

file(READ "../ВЕРСІЯ" TSIL_VERSION)

add_subdirectory(tsil_parser)
add_subdirectory(tsil_llvm)
add_subdirectory(tsil_toc)

set(TSIL_SRC
        main.cpp
        tsil_cli.cpp
        bib.c
        ../.плавлення-КЦ/скомпільоване/КД/КД.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/біб.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/Назва.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/Обʼєкт.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктГрупиДій.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктДії.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктЗначення.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктНезавантаженогоЗначення.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктСекції.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктСирогоЗначення.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктТипу.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/ОбʼєктШаблону.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/Помилка.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/Середовище.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/Тип.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/Ц.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/К.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КВернути.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КВзяти.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КВиконати.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КВиконатиШаблон.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЗвернутись.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЗмінити.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЗмінитиВСекції.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЗмінитиЗаПозицією.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КОбʼєкт.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КТекст.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЧисло.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЗначенняЯкщо.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КОперація.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КОтримати.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КОтриматиЗаПозицією.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КОтриматиЗіСекції.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КПерезаписати.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КПерелік.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КПоки.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КСамоОперація.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КДія.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КСекція.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КСинонім.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КСтруктура.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КТип.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЦіль.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КШаблон.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЯк.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЯкщо.ю8.ц.o
        ../.плавлення-КЦ/скомпільоване/К/КЄ.ю8.ц.o
)

add_executable(tsil ${TSIL_SRC})
target_link_libraries(tsil PUBLIC tsil_parser tsil_llvm tsil_toc)
target_link_options(tsil PUBLIC -static -fvisibility=hidden -flto -Wl,--strip-all)
target_compile_options(tsil PUBLIC -O3 -g0 -fexceptions -DTSIL_VERSION="${TSIL_VERSION}")
set_target_properties(tsil PROPERTIES OUTPUT_NAME "ціль")
